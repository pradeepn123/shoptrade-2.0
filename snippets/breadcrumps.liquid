{%- comment -%}
Parameters:
- show_collection_listing_link {boolean} [optional] - Whether to show the collections list link. Default is false.
- show_next_prev {boolean} [optional] - Whether to show next/previous product links (product template). Default is false.
- show_rss_link {boolean} [optional] - Whether to show an rss link (blog template). Default is false.
- divider {string} [optional] - Markup to use for the divider.
- prev_icon {string} [optional] - Markup to use for the previous (product) button.
- next_icon {string} [optional] - Markup to use for the next (product) button.

Example usage:
{%- capture divider -%}
<span class="feather-icon">{% render 'feather-chevron-right' %}</span>
{%- endcapture -%}
{% render 'breadcrumbs', divider: divider, show_next_prev: true %}
{%- endcomment -%}

{%- liquid
  assign show_crumbs = true
  assign show_structured_data = true
  assign show_collection_listing_link = false
  assign breadcrumbs_title = 'general.breadcrumbs.title' | t
  assign home_title = 'home'
  assign other_templates = 'blog, cart, list-collections, page, search' | split: ', '
  
  if template.name == 'blog' or template.name == 'page'
    assign item_title = [template.name].title
    assign item_url = [template.name].url
  elsif template.name == 'list-collections'
    assign item_title = 'general.breadcrumbs.collections' | t
    assign item_url = routes.collections_url
  elsif template.name == 'collection' or template.name == 'product'
    assign collections_title = 'general.breadcrumbs.collections' | t
  elsif template.name == 'search'
    assign item_title = 'general.search.title' | t
    assign item_url = routes.search_url
    assign show_structured_data = false
  elsif template.name == 'cart'
    assign item_title = 'cart.general.title' | t
    assign item_url = routes.cart_url
    assign show_structured_data = false
  elsif template.directory == 'customers'
    if template.name == 'login'          
      assign item_title = 'customer.login.title' | t 
      assign item_url = routes.account_url
      assign show_structured_data = false
    elsif template.name == 'register'
      assign item_title = 'customer.register.title' | t 
      assign item_url = routes.account_url
      assign show_structured_data = false 
    elsif template.name == 'account'
     assign item_title = 'account'
     assign item_url = routes.account_url
     assign show_structured_data = false 
    elsif template.name == 'addresses'
     assign item_title = 'addresses'
     assign item_url = routes.account_url
     assign show_structured_data = false 
    endif
  endif
  -%}
  
  
  
  {%- if template.name == 'blog' and current_tags -%}
    {%- capture blog_tag_url -%}
      {{ blog.url }}/tagged/{{ current_tags | join: "+" }}{%- endcapture -%}
  {%- endif -%}
  
  {%- unless divider -%}
    {%- capture divider -%}
      {% comment %} <span class="icon">{%- render 'icon' with 'chevron-right', direction_aware: true -%}</span> {% endcomment %}
    {%- endcapture -%}
  {%- endunless -%}
  
  {%- unless prev_icon -%}
    {%- capture prev_icon -%}
      {% comment %} <span class="icon">{%- render 'icon' with 'chevron-left', direction_aware: true -%}</span> {% endcomment %}
    {%- endcapture -%}
  {%- endunless -%}
  
  {%- unless next_icon -%}
    {%- capture next_icon -%}
      {% comment %} <span class="icon">{%- render 'icon' with 'chevron-right', direction_aware: true -%}</span> {% endcomment %}
    {%- endcapture -%}
  {%- endunless -%}
  
  {%- capture crumbs_structured_data -%}
    <script type="application/ld+json">
      {
      "@context": "https://schema.org",
                          "@type": "BreadcrumbList",
                          "itemListElement": [
                            {
                              "@type": "ListItem",
                              "position": 1,
                              "name": {{ home_title | json }},
      "item": {{ shop.url | append: routes.root_url | json }}
      },
  
      {%- if template.name == 'collection' and collection.handle -%}
        {%- assign collection_position = 2 -%}
        {%- if show_collection_listing_link -%}
          {
          "@type": "ListItem",
                                                      "position": 2,
                                                      "name": {{ collections_title | json }},
          "item": {{ shop.url | append: routes.collections_url | json }}
          },
          {%- assign collection_position = 3 -%}
        {%- endif -%}
        {
        "@type": "ListItem",
                                          "position": {{ collection_position }},
        "name": {{ collection.title | json }},
        "item": {{ shop.url | append: collection.url | json }}
        }
  
      {%- elsif template.name == 'product' -%}
        {%- assign product_position = 2 -%}
        {%- if collection -%}
          {%- if show_collection_listing_link -%}
            {
            "@type": "ListItem",
                                                                  "position": 2,
                                                                  "name": {{ collections_title | json }},
            "item": {{ shop.url | append: routes.collections_url | json }}
            },
            {%- assign product_position = 3 -%}
          {%- endif -%}
          {
          "@type": "ListItem",
                                                      "position": {{ product_position }},
          "name": {{ collection.title | json }},
          "item": {{ shop.url | append: collection.url | json }}
          },
          {%- if show_collection_listing_link -%}
            {%- assign product_position = 4 -%}
          {%- else -%}
            {%- assign product_position = 3 -%}
          {%- endif -%}
        {%- endif -%}
        {
        "@type": "ListItem",
                                          "position": {{ product_position }},
        "name": {{ product.title | json }},
        "item": {{ shop.url | append: product.url | json }}
        }
  
      {%- elsif template.name == 'blog' and current_tags -%}
        {
        "@type": "ListItem",
                                          "position": 2,
                                          "name": {{ blog.title | json }},
        "item": {{ shop.url | append: blog.url | json }}
        },
        {
                                          "@type": "ListItem",
                                          "position": 3,
                                          "name": {{ current_tags | join: ", " | json }},
        "item": {{ shop.url | append: blog_tag_url | json }}
        }
  
      {%- elsif template.name == 'article' -%}
        {
        "@type": "ListItem",
                                          "position": 2,
                                          "name": {{ blog.title | json }},
        "item": {{ shop.url | append: blog.url | json }}
        },
        {
                                          "@type": "ListItem",
                                          "position": 3,
                                          "name": {{ article.title | json }},
        "item": {{ shop.url | append: article.url | json }}
        }
  
      {%- else -%}
        {
        "@type": "ListItem",
                                          "position": 2,
                                          "name": {{ item_title | json }},
        "item": {{ shop.url | append: item_url | json }}
        }
      {%- endif -%}
      ]
      }
    </script>
  {%- endcapture -%}
  
  {%- capture crumbs_html -%}
    {%- if request.page_type == 'article' -%}
      <div class="show_article_breadcrumbs">
      {%- endif -%}
      <div class="{%- if request.page_type == 'page' -%}main_breadcrumb_padding{%-else-%}container{%- endif -%}
        {%- if request.page_type == 'product' -%}main_breadcrumb_nopad{%-else-%}{%- endif -%} ">
        <nav class="breadcrumbs {% if request.page_type == 'product' %} rearrange_for_mobile{% endif %}" aria-label="{{ breadcrumbs_title }}">
          <ol class="breadcrumbs-list">
            <li class="breadcrumbs-list__item">
              <a class="breadcrumbs-list__link" href="{{ routes.root_url }}"> {% render 'icon-home' %}  &nbsp; <span class="breadcrump_arrow"> {% render 'icon-breadcrump-arrow' %} </span> </a>
              {{ divider }}
            </li>
  
            {%- if template.name == 'collection' and collection.handle -%}
              {%- if show_collection_listing_link -%}
                <li class="breadcrumbs-list__item">
                  <a class="breadcrumbs-list__link" href="{{ routes.collections_url }}">{{ collections_title | escape }}</a>
                  {{ divider }}
                </li>
              {%- endif -%}
              <li class="breadcrumbs-list__item">
                <a
                  class="breadcrumbs-list__link"
                  href="{{ routes.collections_url }}/{{ collection.handle }}"
                  aria-current="page">{{ collection.title | escape }}</a>
              </li>
  
            {%- elsif template.name == 'product' -%}
              {%- if collection -%}
                {%- if show_collection_listing_link -%}
                  <li class="breadcrumbs-list__item">
                    <a class="breadcrumbs-list__link" href="{{ routes.collections_url }}">{{ collections_title | escape }}</a>
                    {% comment %} {{ divider }} {% endcomment %}
                  </li>
                {%- endif -%}
                <li class="breadcrumbs-list__item">
                  <a class="breadcrumbs-list__link" href="{{ collection.url }}">{{ collection.title | escape }}   &nbsp; <span class="breadcrump_arrow"> {% render 'icon-breadcrump-arrow' %} </span> </a>
                  {% comment %} {{ divider }} {% endcomment %}
                </li>
              {%- endif -%}
              <li class="breadcrumbs-list__item">
                <a
                  class="breadcrumbs-list__link collection-name-link"
                  href="{{ product.url }}"
                  aria-current="page">{{ product.title | escape }} </a>
              </li>
  
            {%- elsif template.name == 'blog' and current_tags -%}
              <li class="breadcrumbs-list__item">
                <a class="breadcrumbs-list__link" href="{{ blog.url }}">{{ blog.title | escape }}</a>
                {% comment %} {{ divider }} {% endcomment %}
              </li>
              <li class="breadcrumbs-list__item">
                <a
                  class="breadcrumbs-list__link"
                  href="{{ blog_tag_url }}"
                  aria-current="page">{{ current_tags | join: ", " }}</a>
              </li>
  
            {%- elsif template.name == 'article' -%}
              <li class="breadcrumbs-list__item">
                <a class="breadcrumbs-list__link" href="{{ blog.url }}">{{ blog.title | escape }}</a>
                {% comment %} {{ divider }} {% endcomment %}
              </li>
              <li class="breadcrumbs-list__item">
                <a
                  class="breadcrumbs-list__link"
                  href="{{ article.url }}"
                  aria-current="page">{{ article.title | escape }}</a>
              </li>
  
            {%- elsif other_templates contains template.name or template.directory == 'customers' -%}
              <li class="breadcrumbs-list__item">
                <a
                  class="breadcrumbs-list__link"
                  href="{{ item_url }}"
                  aria-current="page">{{ item_title | escape }}</a>
              </li>
  
            {%- else -%}
              {%- assign show_crumbs = false -%}
            {%- endif -%}
  
            {%- if show_rss_link -%}
              <li class="breadcrumbs-list__item">
                <a
                  class="breadcrumbs-list__rss icon"
                  href="{{ blog.url }}.atom"
                  title="RSS"
                  arial-label="RSS">{% render 'svg-rss' %}</a>
              </li>
            {%- endif -%}
          </ol>
          {% comment %}
            {%- if show_next_prev and template contains 'product' and collection -%}
              <div class="breadcrumbs-prod-nav">
                {%- if collection.previous_product -%}
                  <a
                    class="breadcrumbs-prod-nav__link breadcrumbs-prod-nav__link--prev"
                    href="{{ collection.previous_product.url }}"
                    title="{{ collection.previous_product.title | escape }}">
                    {{ prev_icon }}
                    <span class="breadcrumbs-prod-nav__text">{{ 'products.product.prev_product' | t }}</span>
                  </a>
                {%- endif -%}
                {%- if collection.next_product -%}
                  <a
                    class="breadcrumbs-prod-nav__link breadcrumbs-prod-nav__link--next"
                    href="{{ collection.next_product.url }}"
                    title="{{ collection.next_product.title | escape }}">
                    <span class="breadcrumbs-prod-nav__text">{{ 'products.product.next_product' | t }}</span>
                    {{ next_icon }}
                  </a>
                {%- endif -%}
              </div>
            {%- endif -%}
          {% endcomment %}
        </nav>
      </div>
      {%- if request.page_type == 'article' -%}
      </div>
    {%- endif -%}
  {%- endcapture -%}
  
  {%- if show_crumbs -%}
    {%- if show_structured_data -%}
      {{ crumbs_structured_data }}
    {%- endif -%}
    {{ crumbs_html }}
  {%- endif -%}